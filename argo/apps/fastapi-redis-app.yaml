apiVersion: argoproj.io/v1alpha1       # ðŸ‘ˆ This is the API version for Argo CD Applications
kind: Application                      # ðŸ‘ˆ We're creating an Argo CD Application resource

metadata:
  name: fastapi-redis                  # ðŸ‘ˆ The name you'll see in the Argo CD dashboard
  namespace: argocd                    # ðŸ‘ˆ This tells Kubernetes to place the object in the `argocd` namespace

spec:
  project: default                     # ðŸ‘ˆ Youâ€™re assigning this to Argo CDâ€™s default project

  source:
    repoURL: https://github.com/notyouravgexec/fastapi-redis-helm.git  # ðŸ‘ˆ The Git repo where your Helm chart lives
    targetRevision: HEAD              # ðŸ‘ˆ Use the latest commit from the default branch (usually `main`)
    path: .                           # ðŸ‘ˆ The chart lives in the root of the repo
    helm:
      valueFiles:
        - values.yaml                 # ðŸ‘ˆ Tell Helm to use `values.yaml` when rendering the chart

  destination:
    server: https://kubernetes.default.svc  # ðŸ‘ˆ Tells Argo CD to deploy to the current cluster it's running in
    namespace: default                       # ðŸ‘ˆ Tells Argo CD to install the app into the `default` namespace

  syncPolicy:
    automated:                      # ðŸ‘ˆ Enable automatic syncing
      prune: true                   # ðŸ‘ˆ If a resource is deleted in Git, remove it from the cluster
      selfHeal: true                # ðŸ‘ˆ If someone manually changes something, revert it to match Git
